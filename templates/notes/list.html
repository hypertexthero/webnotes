{% extends 'base.html' %}
{% block bodyid %}home{% endblock %}
{% block content %}
    {% if latest %} {# the 'latest' variable of the template context is assigned automatically by the django.views.generic.date_based.archive_index generic view - https://docs.djangoproject.com/en/dev/ref/generic-views/#django-views-generic-date-based-archive-index #}
    {% for note in latest %}
        {# https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#ifchanged #}
        {% ifchanged %}
            <hr />
            <h2 class="dateline">{{ note.created|date:"d F Y" }}</h2>
        {% endifchanged %}
        <dl>
            <dt>

                <strong><a href="{% url notes_detail note.id %}">{{ note.title }}</a></strong> <span class="small normal quiet">- Last edited {{note.modified|timesince}} ago by {{ user.first_name }} {{ user.last_name }}</span>
                {% if user.is_authenticated %} 
                    <span class="small normal"> <a class="edit" href="{% url notes_update note.id %}">edit</a> <a class="warning" href="{% url notes_delete note.id %}">delete</a></span>
                {% endif %}
        
            </dt>
            <dd>{{ note.content_html|truncatewords_html:10|safe }}</dd>
        </dl>
    {% endfor %}

    {% else %}
        You don't have any notes.
    {% endif %}
    
{% endblock %}

{% block sidebar %}
    {# http://www.djangrrl.com/post/custom-template-tags-in-django/ #}
{% if user.is_authenticated %} 
    {% load tags %}
    {% latestnote %}
{% endif %}
{% endblock %}